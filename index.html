<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>OFDM Satellite Simulation</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/pyodide/v0.26.2/full/pyodide.js"></script>
</head>
<body>
    <h1>OFDM Satellite Communication Simulation üõ∞Ô∏è</h1>
    <p>This tool simulates sending a text message over a satellite link using OFDM. It models noise, fading, Doppler and lets you choose Forward Error Correction (FEC/Hamming or RS).</p>

    <h2>Simulation Parameters</h2>
    <div class="input-group">
        <div>
            <label for="message">Message:</label>
            <input type="text" id="message" value="Hello from Earth!">
        </div>
        <div>
            <label for="snr">SNR (dB):</label>
            <input type="number" id="snr" value="25" step="1">
        </div>
        <div>
            <label for="k_db">Rician K-factor (K<sub>dB</sub>):</label>
            <input type="number" id="k_db" value="20" step="1" min="0">
        </div>
        <div>
            <label for="doppler_norm">Normalized Doppler (f<sub>d</sub> / F<sub>s</sub>):</label>
            <input type="number" id="doppler_norm" value="0.000" step="0.0001" min="0">
        </div>
        <div>
            <label for="k_subcarriers">Number of Subcarriers (K):</label>
            <input type="number" id="k_subcarriers" value="64" step="16" min="16">
        </div>
        <div>
            <label for="fec_type">FEC Scheme:</label>
            <select id="fec_type">
                <option value="hamming">Hamming (7,4)</option>
                <option value="reed_solomon">Reed-Solomon (255,223)</option>
            </select>
        </div>
        <div>
            <label for="mod_scheme">Modulation Scheme:</label>
            <select id="mod_scheme">
                <option value="QPSK">QPSK (2 bits/sym)</option>
                <option value="BPSK">BPSK (1 bit/sym)</option>
                <option value="16QAM">16-QAM (4 bits/sym)</option>
                <option value="64QAM">64-QAM (6 bits/sym)</option>
            </select>
        </div>
        <div>
            <label for="symbol_rate">Symbol Rate (MSym/s):</label>
            <input type="number" id="symbol_rate" value="1.0" step="0.1" min="0.1">
        </div>
        </div>

    <button id="run-sim-button">Run Simulation</button>
    
    <div id="data-rate-output">Effective Data Rate: -</div>

    <h2>Simulation Pipeline Visualization</h2>
    <div class="pipeline-container">
        <div class="pipeline-stage">
            <h3>1. Encoding (Ground Station üì°)</h3>
            <div id="viz-encoding" class="viz-box">
                </div>
        </div>
        <div class="pipeline-stage">
            <h3>2. Transmission (OFDM Grid)</h3>
            <div id="viz-ofdm-grid" class="viz-box">
                </div>
        </div>
        <div class="pipeline-stage">
            <h3>3. Channel (Space Link üõ∞Ô∏è)</h3>
            <img id="plot-channel" src="" alt="Channel Response">
        </div>
        <div class="pipeline-stage">
            <h3>4. Decoding (Receiver üì°)</h3>
            <div id="viz-decoding" class="viz-box">
                </div>
            <img id="plot" src="" alt="Constellation Diagram">
        </div>
    </div>

    <div id="output">Simulation results will appear here...</div>

    <script src="app.js"></script>
</body>
</html>